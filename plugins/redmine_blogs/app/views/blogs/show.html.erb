<% if @blog.editable_by?(User.current) %>
<div class="contextual">
<%= link_to l(:button_edit), "#",
            :class => 'icon icon-edit',
            :accesskey => accesskey(:edit),
            :onclick => '$("#edit-blog").show(); return false;' %>
<%= link_to l(:button_delete),
            { :controller => 'blogs',
              :action => 'destroy',
              :id => @blog },
            :confirm => l(:text_are_you_sure),
            :method => :delete,
            :class => 'icon icon-del' %>
</div>

<div id="edit-blog" style="display:none;">
<%= labelled_form_for :blog, @blog,
                      :url => { :controller => 'blogs',
                                :action => 'edit',
                                :id => @blog },
                      :html => { :id => 'blog-form', 
                                 :class => nil,
                                 :multipart => true } do |f| %>
<%= render :partial => 'form', :locals => { :f => f } %>
<%= submit_tag l(:button_save) %>
<%= preview_link({ :controller => 'blogs', :action => 'preview', :id => @blog }, 'blog-form') %>
| <%= link_to l(:button_cancel), "#", :onclick => '$("#edit-blog").hide();' %>
<% end %>
<div id="preview" class="wiki"></div></div>
<% else %>
<div class="contextual"></div>
<% end %>

<h2><%= @blog.title %></h2>

<div class="wiki" style="clear:both;">
<%= textilizable(@blog, :full_description) %>
</div>

<p class="author">Posted on <%= authoring @blog.created_on, @blog.author %></p>

<script async src="https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&autoLogAppEvents=1&version=v2.12&appId=1927655763976170" charset="utf-8"></script>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<script async src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8"></script>

<div style="display:flex;">
<div style="margin:5px;"><a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a></div>
<div style="margin:5px;"><div class="fb-share-button" data-href="<%= url_for %>" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=<%= CGI.escape url_for(:only_path => false) %>&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">シェア</a></div></div>
<div style="margin:5px;"><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a></div>
</div>

<%= link_to_attachments @blog %>

<hr />

<div id="paginate" style="display:none;">
<% unless @prev.nil? %>
<fieldset class="box article">
  <legend>新しい記事 (<%= authoring @prev.created_on, @prev.author %>)</legend>
  <h3><%= link_to @prev.title, :controller => 'blogs', :action => 'show', :id => @prev %></h3>
  <div class="wiki">
    <%= textilizable(@prev, :short_description) %>
  </div>
</fieldset>
<% else %>
<fieldset class="box article no-article"></fieldset>
<% end %>
<% unless @next.nil? %>
<fieldset class="box article">
  <legend>過去の記事 (<%= authoring @next.created_on, @next.author %>)</legend>
  <h3><%= link_to @next.title, :controller => 'blogs', :action => 'show', :id => @next %></h3>
  <div class="wiki">
    <%= textilizable(@next, :short_description) %>
  </div>
</fieldset>
<% else %>
<fieldset class="box article no-article"></fieldset>
<% end %>
</div>

<% html_title @blog.title -%>
